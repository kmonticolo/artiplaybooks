- hosts: all
  become: yes
  vars:
  #aide_cron_sched_hr: 12
    aide_cron_schedule_check: false # we run job from jenkins
    aide_rules:

      - name: "define include path"
        rule: "NORMAL"
        paths:
           - "/boot"
           - "/bin"
           - "/sbin"
           - "/lib"
           - "/lib64"
           - "/opt"
           - "/usr"
           - "/root"
           - "/etc/exports"
           - "/etc/fstab"
           - "/etc/passwd"
           - "/etc/group"
           - "/etc/gshadow"
           - "/etc/shadow"
           - "/etc/security/opasswd"
           - "/etc/hosts.allow"
           - "/etc/hosts.deny"
           - "/etc/sudoers"
           - "/etc/skel"
           - "/etc/logrotate.d"
           - "/etc/nscd.conf"
           - "/etc/securetty"
           - "/etc/profile"
           - "/etc/bashrc"
           - "/etc/bash_completion.d/"
           - "/etc/login.defs"
           - "/etc/zprofile"
           - "/etc/zshrc"
           - "/etc/zlogin"
           - "/etc/zlogout"
           - "/etc/profile.d/"
           - "/etc/X11/"
           - "/etc/yum.conf"
           - "/etc/yumex.conf"
           - "/etc/yumex.profiles.conf"
           - "/etc/yum"
           - "/etc/yum.repos.d/"

      - name: "perms"
        rule: "PERMS"
        paths:
           - "/etc"

      - name: "lspp"
        rule: "LSPP"
        paths:
           - "/etc/audit/"
           - "/etc/libaudit.conf"
           - "/usr/sbin/stunnel"
           - "/var/spool/at"
           - "/etc/at.allow"
           - "/etc/at.deny"
           - "/etc/cron.allow"
           - "/etc/cron.deny"
           - "/etc/cron.d/"
           - "/etc/cron.daily/"
           - "/etc/cron.hourly/"
           - "/etc/cron.monthly/"
           - "/etc/cron.weekly/"
           - "/etc/crontab"
           - "/var/spool/cron/root"
           - "/etc/login.defs"
           - "/etc/securetty"
           - "/var/log/faillog"
           - "/var/log/lastlog"
           - "/etc/hosts"
           - "/etc/sysconfig"
           - "/etc/inittab"
           - "/etc/grub"
           - "/etc/rc.d"
           - "/etc/ld.so.conf"
           - "/etc/localtime"
           - "/etc/sysctl.conf"
           - "/etc/modprobe.conf"
           - "/etc/pam.d"
           - "/etc/security"
           - "/etc/aliases"
           - "/etc/postfix"
           - "/etc/ssh/sshd_config"
           - "/etc/ssh/ssh_config"
           - "/etc/stunnel"
           - "/etc/vsftpd.ftpusers"
           - "/etc/vsftpd"
           - "/etc/issue"
           - "/etc/issue.net"
           - "/etc/cups"

    roles:
      - ahuffman.aide
